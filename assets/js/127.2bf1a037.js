(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{639:function(t,e,o){"use strict";o.r(e);var a=o(23),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("p",[t._v("This page covers the steps to quickly set up a custom domain using CloudFlare. To use a custom domain with Okta, you need to have access to its DNS settings, and you need to create a TLS certificate. Cloudflare makes this easy.")]),t._v(" "),o("p",[t._v("Already set everything up using the manual steps on the previous pages? Move on to the "),o("GuideLink",{attrs:{link:"../next-steps"}},[t._v("Next steps")]),t._v(" page.")],1),t._v(" "),o("h2",{attrs:{id:"transfer-your-domain-and-create-a-certificate"}},[t._v("Transfer your domain and create a certificate "),o("a",{staticClass:"header-anchor header-link",attrs:{href:"#transfer-your-domain-and-create-a-certificate"}},[o("svg",{attrs:{viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"}})])])]),t._v(" "),o("blockquote",[o("p",[o("strong",[t._v("Note:")]),t._v(" "),o("a",{attrs:{href:"https://dash.cloudflare.com/sign-up",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sign up for Cloudflare"),o("OutboundLink")],1),t._v(" if you don't have an account.")])]),t._v(" "),o("p",[t._v("Sign in to Cloudflare and select "),o("strong",[t._v("+Add Site")]),t._v(". It's best if you point an entire domain at Cloudflare. For example, "),o("code",[t._v("example.com")]),t._v(". The free plan is good enough for these steps.")]),t._v(" "),o("p",[t._v("After transferring your domain, you need to create an origin CA certificate:")]),t._v(" "),o("ol",[o("li",[o("p",[t._v("Select the "),o("strong",[t._v("SSL/TLS")]),t._v(" app, and then click "),o("strong",[t._v("Origin Server")]),t._v(".")])]),t._v(" "),o("li",[o("p",[t._v("Click "),o("strong",[t._v("Create Certificate")]),t._v(" to open the "),o("strong",[t._v("Origin Certificate Installation")]),t._v(" dialog box.")])]),t._v(" "),o("li",[o("p",[t._v("Select "),o("strong",[t._v("Let Cloudflare generate a private key and a CSR")]),t._v(".")])]),t._v(" "),o("li",[o("p",[t._v("Change "),o("strong",[t._v("Certificate Validity")]),t._v(" to "),o("strong",[t._v("1 year")]),t._v(" (Okta rejects certificates with a 15-year expiration), and then click "),o("strong",[t._v("Next")]),t._v(".")])]),t._v(" "),o("li",[o("p",[t._v("Copy the "),o("strong",[t._v("Origin Certificate")]),t._v(" to a "),o("code",[t._v("tls.cert")]),t._v(" file on your hard drive, and then copy the "),o("strong",[t._v("Private key")]),t._v(" to "),o("code",[t._v("private.key")]),t._v(".")])]),t._v(" "),o("li",[o("p",[t._v("In Okta, go to "),o("strong",[t._v("Customization")]),t._v(" > "),o("strong",[t._v("Domain Name")]),t._v(" > "),o("strong",[t._v("Edit")]),t._v(" > "),o("strong",[t._v("Get Started")]),t._v(".")])]),t._v(" "),o("li",[o("p",[t._v("Enter a subdomain name (for example: "),o("code",[t._v("id.example.com")]),t._v(") and click "),o("strong",[t._v("Next")]),t._v(". You are prompted to verify domain ownership.")])]),t._v(" "),o("li",[o("p",[t._v("In Cloudflare, add the specified "),o("code",[t._v("TXT")]),t._v(" record using the "),o("strong",[t._v("DNS")]),t._v(" > "),o("strong",[t._v("+ Add record")]),t._v(" option.")])]),t._v(" "),o("li",[o("p",[t._v("In Okta, select "),o("strong",[t._v("Verify")]),t._v(" > "),o("strong",[t._v("Next")]),t._v(".")])]),t._v(" "),o("li",[o("p",[t._v("In the "),o("strong",[t._v("Certificate")]),t._v(" box, copy/paste the contents of "),o("code",[t._v("tls.cert")]),t._v(".")]),t._v(" "),o("blockquote",[o("p",[o("strong",[t._v("Note:")]),t._v(" On a Mac you can use "),o("code",[t._v("cat tls.cert | pbcopy")]),t._v(" in a terminal to copy the file to your clipboard.")])])]),t._v(" "),o("li",[o("p",[t._v("Paste the contents of "),o("code",[t._v("private.key")]),t._v(" in the "),o("strong",[t._v("Private key")]),t._v(" box. Click "),o("strong",[t._v("Next")]),t._v(".")])]),t._v(" "),o("li",[o("p",[t._v("You are prompted to add a "),o("a",{attrs:{href:"https://en.wikipedia.org/wiki/CNAME_record",target:"_blank",rel:"noopener noreferrer"}},[t._v("CNAME record"),o("OutboundLink")],1),t._v(". Add this to your Cloudflare DNS, and then click "),o("strong",[t._v("Finish")]),t._v(".")])]),t._v(" "),o("li",[o("p",[t._v("Wait until "),o("code",[t._v("https://<id.domain.name>")]),t._v(" resolves in your browser before you continue.")])])]),t._v(" "),o("blockquote",[o("p",[o("strong",[t._v("Note:")]),t._v(" When you first try this, it's possible that your network caches DNS entries, and you won't be able to get to "),o("code",[t._v("id.example.com")]),t._v(". As a workaround, you can tether with your phone, then graph the IP address and add it as an entry to your "),o("code",[t._v("hosts")]),t._v(".")])]),t._v(" "),o("h2",{attrs:{id:"configure-a-custom-domain-for-your-authorization-server"}},[t._v("Configure a custom domain for your Authorization Server "),o("a",{staticClass:"header-anchor header-link",attrs:{href:"#configure-a-custom-domain-for-your-authorization-server"}},[o("svg",{attrs:{viewBox:"0 0 512 512"}},[o("path",{attrs:{fill:"currentColor",d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"}})])])]),t._v(" "),o("p",[t._v("The OpenID Connect specification requires a "),o("code",[t._v("./well-known/openid-configuration")]),t._v(" endpoint with metadata about your app's endpoints. You should be able to see yours at:")]),t._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[t._v("https://<id.domain.name>/oauth2/default/.well-known/openid-configuration\n")])])]),o("p",[t._v("You might notice that it has your Okta "),o("code",[t._v("dev-*")]),t._v(" domain, rather than your custom domain name.")]),t._v(" "),o("p",[t._v("You need to update your Authorization Server to use your custom domain to fix this:")]),t._v(" "),o("ol",[o("li",[t._v("Sign in to your Okta account and go to "),o("strong",[t._v("API")]),t._v(" > "),o("strong",[t._v("Authorization Servers")]),t._v(".")]),t._v(" "),o("li",[t._v("Select the  "),o("strong",[t._v("default")]),t._v(" Custom Authorization Server, and then click "),o("strong",[t._v("Edit")]),t._v(".")]),t._v(" "),o("li",[t._v("Change the "),o("strong",[t._v("Issuer")]),t._v(" to use "),o("strong",[t._v("Custom URL")]),t._v(".")]),t._v(" "),o("li",[t._v("Try "),o("code",[t._v("./well-known/openid-configuration")]),t._v(" again. It should now display your custom domain.")])]),t._v(" "),o("NextSectionLink",[t._v("Next steps")])],1)}),[],!1,null,null,null);e.default=r.exports}}]);